<!DOCTYPE html>
<html style="padding:0;margin:0;">
	<body style="padding:0;margin:0;overflow: hidden;">
		<canvas id="screen"></canvas>
		<script>
			function randomRange(low, high){
				var difference = high-low;
				var output = Math.random();
				output = Math.round(output*difference)+low;
				return output;
			}
			var canvas = document.getElementById('screen');
			var ctx = canvas.getContext('2d');
			function canvasResize() {
				canvas.width  = window.innerWidth;
				canvas.height = window.innerHeight;
				ctx.fillStyle = '#23272A';
				ctx.fillRect(0, 0, canvas.width, canvas.height);
			}
			canvasResize();
			window.onresize = canvasResize;
			ctx.fillStyle = 'black';
			ctx.fillRect(0, 0, canvas.width, canvas.height);

			var boids = []
			var distances = []

			//function dist(bo1d, bo2d){
			//	xdist = boids[bo1d].x - boids[bo2d].x
			//	ydist = boids[bo1d].y - boids[bo2d].y
			//	return [xdist, ydist]
			//}
			function dist(bo1d){
				xdist = canvas.width/2 - bo1d.x
				ydist = canvas.height/2 - bo1d.y
				return [xdist, ydist]
			}
			function addParticlesOnClick(event){
				var x = event.clientX;
				var y = event.clientY;
				for(var i = 0; i < 4; i++){
					boid = new Boid(x, y);
					boids.push(boid)
				}
				
			}
			canvas.addEventListener('mousedown', addParticlesOnClick);


			class Boid{
				constructor(){
					this.x = randomRange(0, canvas.width)
					this.y = randomRange(0, canvas.height)
					this.angle = 2*Math.random()*Math.PI
					this.speed = 3
					this.size = 9
				}
				draw(){
					ctx.lineWidth = 8;
					ctx.strokeStyle = 'red'
					ctx.lineJoin = 'round';
					ctx.beginPath();
					ctx.moveTo(this.x, this.y);
					ctx.lineTo(this.x+this.size*Math.sin(this.angle+1.35*Math.PI), this.y+this.size*Math.cos(this.angle+1.35*Math.PI));
					ctx.lineTo(this.x+this.size*1.3*Math.sin(this.angle), this.y+this.size*1.3*Math.cos(this.angle));
					ctx.lineTo(this.x+this.size*Math.sin(this.angle+0.65*Math.PI), this.y+this.size*Math.cos(this.angle+0.65*Math.PI));
					ctx.lineTo(this.x, this.y);
					ctx.closePath();
					ctx.stroke();

					var distance = []
					distance = dist(this)
					
					var xspeed = 0
					var yspeed = 0
					xspeed = this.speed * Math.sin(this.angle) + distance[0]/2000
					yspeed = this.speed * Math.cos(this.angle) + distance[1]/2000
					if(yspeed >= 0){
						console.log("down")
						this.angle = Math.atan(xspeed/yspeed)
					} else {
						this.angle = Math.atan(xspeed/yspeed)+Math.PI
						console.log("up")
					}
					this.speed = Math.sqrt(Math.pow(xspeed, 2)+Math.pow(yspeed, 2))
					this.x = this.x + xspeed
					this.y = this.y + yspeed
				}
			}
			setInterval(function(){
				ctx.fillStyle = 'black';
				ctx.fillRect(0, 0, canvas.width, canvas.height);

				for(var i = 0; i < boids.length; i++){
					boids[i].draw()
				}

			}, 20)

		</script>
	</body>
</html>